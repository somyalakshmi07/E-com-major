<%- include('partials/header') %>

    <main class="wishlist-page">
        <div class="container">
            <h1>Your Wishlist</h1>
            
            <% if (wishlistItems.length === 0) { %>
                <div class="empty-wishlist">
                    <p>Your wishlist is empty</p>
                    <a href="/shop" class="btn">Start Shopping</a>
                </div>
            <% } else { %>
                <div class="wishlist-grid">
                    <% wishlistItems.forEach(item => { %>
                        <div class="wishlist-item">
                            <div class="item-image" style="background-image: url('<%= item.image %>')"></div>
                            <div class="item-details">
                                <h3><%= item.name %></h3>
                                <p class="item-price">$<%= item.price.toFixed(2) %></p>
                                <div class="item-actions">
                                    <button class="add-to-cart" data-id="<%= item.id %>">Add to Cart</button>
                                    <button class="remove-wishlist" data-id="<%= item.id %>">Remove</button>
                                </div>
                            </div>
                        </div>
                    <% }); %>
                </div>
            <% } %>
        </div>
    </main>

<%- include('partials/footer') %>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Add to cart from wishlist
        document.querySelectorAll('.add-to-cart').forEach(btn => {
            btn.addEventListener('click', function() {
                const productId = this.getAttribute('data-id');
                
                fetch('/cart/add', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ productId }),
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('Item added to cart!');
                    }
                });
            });
        });
        
        // Remove from wishlist
        document.querySelectorAll('.remove-wishlist').forEach(btn => {
            btn.addEventListener('click', function() {
                const productId = this.getAttribute('data-id');
                
                fetch('/wishlist/toggle', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ productId }),
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        location.reload();
                    }
                });
            });
        });
    });
</script>